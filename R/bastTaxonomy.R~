library(taxonomizr)

TaxDB <- "/SAN/db/taxonomy/update20200827/accessionTaxa.sql"


BLAf <- "/SAN/MinKnowNamibia/ParasiteLongAmprDNA/BarCodedSamples/barcode04_1000sectionVSnt.blt"
## BLAf <-  "/SAN/MinKnowNamibia/ParasiteLongAmprDNA/BarCodedSamples/barcode89_300sectionVSnt.blt"

BLA <- read.delim(BLAf, header=FALSE)

names(BLA) <-  c("qaccver", "saccver", "pident", "length",
                 "mismatch", "gapopen", "qstart", "qend", "sstart", "send", "staxid")

hist(BLA$send - BLA$sstart)


fullTax <- getTaxonomy(BLA$staxid, TaxDB)

BLATax <- cbind(BLA, fullTax)

table(BLATax[!duplicated(BLATax$qaccver), "phylum"])

table(BLATax[,"phylum"])

hist(BLATax[, "pident"])


table(BLATax[BLATax$pident>95, "phylum"])

table(BLATax[BLATax$pident>90, "phylum"])
